import { describe, test } from "vitest";
import { SequenceRunner } from "../framework.js";

export const data = (run: SequenceRunner) => {
  describe("Present Smart-Fill", () => {
    test(`Basic Test`, async () => {
      await run(
        `
      ┌─────┬─────┬─────┬─────┬─────┬─────┐
      │     │     │     │     │ B   │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │ B   │     │     │ E   │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │ B   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │ B   │     │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │ B   │     │     │
      └─────┴─────┴─────┴─────┴─────┴─────┘
    `,
        `
      ┌─────┬─────┬─────┬─────┬─────┬─────┐
      │     │.  1 │     │     │ B   │.  1 │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │ B   │.  1 │     │ E   │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │>E1  │     │.  1 │ B   │.1   │.1   │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │  p  │>P2  │  s  │  s  │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │.  1 │ B   │>P3  │  p  │  s  │  s  │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │.  1 │     │     │ B   │*1 1 │*1 1 │
      └─────┴─────┴─────┴─────┴─────┴─────┘
    `
      );
    });

    test("Correctly smart fill based on diagonal data", async () => {
      await run(
        `
      ┌─────┬─────┬─────┬─────┬─────┬─────┐
      │     │     │     │     │ B   │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │ B   │     │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │ B   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ P   │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │ B   │     │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │ B   │ S   │     │
      └─────┴─────┴─────┴─────┴─────┴─────┘
    `,
        `
    ┌─────┬─────┬─────┬─────┬─────┬─────┐
    │     │*  1 │     │     │ B   │*  1 │
    ├─────┼─────┼─────┼─────┼─────┼─────┤
    │     │ B   │     │     │     │     │
    ├─────┼─────┼─────┼─────┼─────┼─────┤
    │     │     │*  1 │ B   │     │     │
    ├─────┼─────┼─────┼─────┼─────┼─────┤
    │     │     │ P   │  p  │  s  │  s  │
    ├─────┼─────┼─────┼─────┼─────┼─────┤
    │     │ B   │  p  │>P   │  s  │  s  │
    ├─────┼─────┼─────┼─────┼─────┼─────┤
    │*  1 │     │     │ B   │ S   │  s  │
    └─────┴─────┴─────┴─────┴─────┴─────┘
  `
      );
    });

    test("Correctly smart fill based on horizontal line with one side blocked", async () => {
      await run(
        `
      ┌─────┬─────┬─────┬─────┬─────┬─────┐
      │     │     │     │     │ B   │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │ B   │     │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │ B   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ P   │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │ B   │     │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │ B   │ S   │     │
      └─────┴─────┴─────┴─────┴─────┴─────┘
    `,
        `
    ┌─────┬─────┬─────┬─────┬─────┬─────┐
    │     │*  1 │     │     │ B   │*  1 │
    ├─────┼─────┼─────┼─────┼─────┼─────┤
    │     │ B   │     │     │     │     │
    ├─────┼─────┼─────┼─────┼─────┼─────┤
    │     │     │*  1 │ B   │     │     │
    ├─────┼─────┼─────┼─────┼─────┼─────┤
    │     │     │ P   │  p  │  s  │  s  │
    ├─────┼─────┼─────┼─────┼─────┼─────┤
    │     │ B   │>P   │  p  │  s  │  s  │
    ├─────┼─────┼─────┼─────┼─────┼─────┤
    │*  1 │     │     │ B   │ S   │  s  │
    └─────┴─────┴─────┴─────┴─────┴─────┘
  `
      );
    });

    test("Correctly smart fill based on vertical line with one side blocked", async () => {
      await run(
        `
        ┌─────┬─────┬─────┬─────┬─────┬─────┐
        │ S   │     │     │     │     │     │
        ├─────┼─────┼─────┼─────┼─────┼─────┤
        │     │     │ B   │     │     │     │
        ├─────┼─────┼─────┼─────┼─────┼─────┤
        │     │     │     │     │ B   │     │
        ├─────┼─────┼─────┼─────┼─────┼─────┤
        │     │     │     │     │     │ B   │
        ├─────┼─────┼─────┼─────┼─────┼─────┤
        │     │ B   │     │     │ P   │     │
        ├─────┼─────┼─────┼─────┼─────┼─────┤
        │     │     │     │ B   │     │     │
        └─────┴─────┴─────┴─────┴─────┴─────┘
      `,
        `
        ┌─────┬─────┬─────┬─────┬─────┬─────┐
        │ S   │  s  │     │     │     │     │
        ├─────┼─────┼─────┼─────┼─────┼─────┤
        │  s  │  s  │ B   │     │     │     │
        ├─────┼─────┼─────┼─────┼─────┼─────┤
        │  s  │  s  │     │     │ B   │     │
        ├─────┼─────┼─────┼─────┼─────┼─────┤
        │     │     │     │  p  │  p  │ B   │
        ├─────┼─────┼─────┼─────┼─────┼─────┤
        │     │ B   │     │>P   │ P   │     │
        ├─────┼─────┼─────┼─────┼─────┼─────┤
        │     │     │     │ B   │     │     │
        └─────┴─────┴─────┴─────┴─────┴─────┘
      `
      );
    });

    test("Correctly smart fill against top-left edge", async () => {
      await run(
        `
      ┌─────┬─────┬─────┬─────┬─────┬─────┐
      │     │     │ B   │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ B   │ B   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │ S   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ S   │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ B   │ B   │     │     │
      └─────┴─────┴─────┴─────┴─────┴─────┘
    `,
        `
      ┌─────┬─────┬─────┬─────┬─────┬─────┐
      │>P   │  p  │ B   │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │  p  │  p  │ B   │ B   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │  s  │ S   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │  s  │  s  │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ S   │  s  │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ B   │ B   │     │     │
      └─────┴─────┴─────┴─────┴─────┴─────┘
      [Warning] Blocked tile pattern does not match any known patterns; Fox suggestions are not available.
    `
      );
    });
    test("Correctly smart fill against top-right edge", async () => {
      await run(
        `
      ┌─────┬─────┬─────┬─────┬─────┬─────┐
      │     │     │ B   │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ B   │ B   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │ S   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ S   │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ B   │ B   │     │     │
      └─────┴─────┴─────┴─────┴─────┴─────┘
    `,
        `
      ┌─────┬─────┬─────┬─────┬─────┬─────┐
      │     │     │ B   │     │  p  │>P   │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ B   │ B   │  p  │  p  │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │  s  │ S   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │  s  │  s  │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ S   │  s  │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ B   │ B   │     │     │
      └─────┴─────┴─────┴─────┴─────┴─────┘
      [Warning] Blocked tile pattern does not match any known patterns; Fox suggestions are not available.
    `
      );
    });
    test("Correctly smart fill against bottom-left edge", async () => {
      await run(
        `
      ┌─────┬─────┬─────┬─────┬─────┬─────┐
      │     │     │ B   │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ B   │ B   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │ S   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ S   │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ B   │ B   │     │     │
      └─────┴─────┴─────┴─────┴─────┴─────┘
    `,
        `
      ┌─────┬─────┬─────┬─────┬─────┬─────┐
      │     │     │ B   │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ B   │ B   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │  s  │ S   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │  s  │  s  │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │  p  │  p  │ S   │  s  │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │>P   │  p  │ B   │ B   │     │     │
      └─────┴─────┴─────┴─────┴─────┴─────┘
      [Warning] Blocked tile pattern does not match any known patterns; Fox suggestions are not available.
    `
      );
    });
    test("Correctly smart fill against bottom-right edge", async () => {
      await run(
        `
      ┌─────┬─────┬─────┬─────┬─────┬─────┐
      │     │     │ B   │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ B   │ B   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │ S   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │     │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ S   │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ B   │ B   │     │     │
      └─────┴─────┴─────┴─────┴─────┴─────┘
    `,
        `
      ┌─────┬─────┬─────┬─────┬─────┬─────┐
      │     │     │ B   │     │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ B   │ B   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │  s  │ S   │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │  s  │  s  │     │     │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ S   │  s  │  p  │  p  │
      ├─────┼─────┼─────┼─────┼─────┼─────┤
      │     │     │ B   │ B   │  p  │>P   │
      └─────┴─────┴─────┴─────┴─────┴─────┘
      [Warning] Blocked tile pattern does not match any known patterns; Fox suggestions are not available.
    `
      );
    });
  });
};
